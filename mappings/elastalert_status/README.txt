В двух файлах находится один и тот же маппинг для разных случаев:

1) elastalert_status_template.json - для паппита, по примеру из "modules_iss_files_elasticsearch_templates_cef.json",
для reindex от kibana tools

2) elastalert_status.txt - чтобы поменять маппинг индекса при создании клона через kaizen.




Как поменять индекс уже созданного индекса?

Когда впервые появилась ошибка несоответствия полей в логах ElastAlert (EA), проблема решилась созданием клона индекса
с точечной корректировкой  поля в маппинге.
Если индекс elastalert_status уже создан в ES и если EA уже работал с ним, то не надо удалять индекс elastalert_status
и создавать новый пустой elastalert_status, а то EA забудет прогрессс и не сможет корректно продолжить работу.
Для корректировки маппинга остается только вариант с созданием клона индекса.
1) [SSH] Останавливаем службу EA.
2) [Kaizen] Создаем клон индекса elastalert_status с новым именем elastalert_status_clone
3) [Kaizen] Удаляем оригинальный индекс elastalert_status
4) [Kaizen] Создаем клон индекса elastalert_status_clone:
    4.1) Название: elastalert_status
    4.2) Копируем содержимое elastalert_status.txt и вставляем в окно маппинга создаваемого индекса
5*) [Kaizen] Буфферный индекс elastalert_status_clone пока моно оставить, на всякий случай.
    Если прям надо удалить клон, то удалите через 30 дней нормальной работы EA с новым индексом.
6) [SSH] Запускаем службу EA
7*) [SSH] Проверяем логи EA, нет ли ошибок.

* - дополнительные пункты
